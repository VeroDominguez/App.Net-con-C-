@using Dominio.Models
@model List<Dominio.Models.Reserva>



<h1>Lista de Agendas Por Fecha</h1>

<form method="post">
    <label>Filtrar por fecha:</label>
    <input type="date" placeholder="@DateTime.Today" name="fecha" />
    <input type="submit" value="Filtrar" />
</form>
<br />
<p>@ViewBag.msgNoAgendaFechaBuscada</p>
<p>@ViewBag.msg</p>
<p>@ViewBag.msgFaltaIngresarFecha</p>
<br />

<table class="table">
    <tr>
        <th>Nombre Huésped</th>
        <th>Nombre Actividad</th>
        <th>Fecha de la actividad</th>
        <th>Lugar</th>
        <th>Costo final</th>
        <th>Nombre Proveedor</th>
        <th>Fecha de la agenda</th>
        <th>Estado de la agenda</th>
        <th>---</th>
    </tr>


    @foreach (Reserva r in Model)
    {
        <tr>
            <td>@r.Huesped.Nombre @r.Huesped.Apellido</td>
            <td>@r.Actividad.Nombre</td>
            <td>@r.Actividad.Fecha.ToShortDateString()</td>


            @if (r.Actividad.GetTipo() == "OrgHostal")
            {
                <td>@r.Actividad.MostrarLugarOProveedor()</td>
                @if (r.Actividad.CalcularCostoFinal(r.Huesped) == 0)
                {
                    <td>Actividad Gratuita</td>
                }
                else
                {
                    <td>@r.Actividad.CalcularCostoFinal(r.Huesped) dólares</td>
                }

                <td>---</td>
                <td>@r.FechaReserva</td>
                <td>@r.EstadoReserva</td>

                @if (r.EstadoReserva != "CONFIRMADA")
                {
                    <td>@Html.ActionLink("Confirmar", "Edit", "Agenda", new {id = r.Id})</td>
                }
            }
            else
            {
                <td>---</td>
                
                @if (r.Actividad.CalcularCostoFinal(r.Huesped) == 0)
                {
                    <td>Actividad Gratuita</td>
                }
                else
                {
                    <td>@r.Actividad.CalcularCostoFinal(r.Huesped) dólares</td>
                }

                <td>@r.Actividad.MostrarLugarOProveedor()</td>
                <td>@r.FechaReserva</td>
                <td>@r.EstadoReserva</td>

                @if (r.EstadoReserva != "CONFIRMADA")
                {
                    <td>@Html.ActionLink("Confirmar", "Edit", "Agenda", new {id = r.Id})</td>
                }
            }
        </tr>
    }
</table>


